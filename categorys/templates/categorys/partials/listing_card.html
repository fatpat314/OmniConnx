
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css" integrity="sha384-VCmXjywReHh4PwowAiWNagnWcLhlEJLA5buUprzK8rxFgeH0kww/aWY76TfkUoSX" crossorigin="anonymous">
    </head>

<body>

<div class="card mb-3">
    <div class="card-header">
        <h5>{{ listing.title }}</h5>
        <h6>{{ listing.sub_category }}</h6>

    </div>
  <a href="/view/{{ listing.author.profile.slug }}"><img class="rounded-circle" style="width:75px;height:75px;" src="{{ listing.author.profile.image.url }}"></a>

  <small class="text-muted">Last updated {{ listing.modified|date:"SHORT_DATETIME_FORMAT" }} by <b>{{ listing.author.username }}</b></small>
  <a class="nav-link" href="/view/{{ listing.author.profile.slug }}">View Profile <span class="sr-only">(current)</span></a>
  <div class="card-body border-dark">


<!-- <p>{{ listing.content | truncatewords_html:10}}</p>
    <details>

    <summary>Read More...</summary>

          <p>{{ listing.content }}</p>
      </details> -->

        <span class="dots">{{ listing.content | truncatewords_html:10}}...</span>
          <span class="more">{{ listing.content }}</span>

      <hr>
       <a onclick="myFunction()" class="myBtn" style="justify-content: right;">Read more</a>
<hr>

<div>

  <button 
  class="btn btn-primary btn__first" 
  data-toggle="collapse"
  data-target="#post-{{listing.id}}"
  data-text="Collapse"
  >
  Read Comments
</button>

<div class="block collapse" id="post-{{listing.id}}">
  <div class="block__content">
    <a href="{% url 'post' pk=listing.id %}">Comments: {{ post.comments.all }}</a>

{% for comment in listing.comments.all %}
<div class="date">{{ comment.created_date }}</div>
<h6><strong>{{ comment.author }}</strong></h6>
<strong><p>{{ comment.text }}</p></strong>
<hr>
{% empty %}
<p>No comments here yet :(</p>
{% endfor %}
    <hr>
    <!-- <button type="button" class="btn btn-primary" onclick='openModal()'>
      Add comment
  </button>
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-modal="true"
    role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" aria-label="Close" onclick="closeModal()">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
              <h1>New comment</h1>
              <form method="POST" class="post-form">{% csrf_token %}
                  {{ form.as_p }}
                  <button type="submit" class="save btn btn-default" name="send-button">Send</button>
              </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal-backdrop fade show" id="backdrop" style="display: none;"></div> -->
    <!-- <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=listing.id %}">Add comment</a> -->
  </div>
</div>

</div> 


</div> 
    
      
  </div>

  <script>
    function myFunction(elem) {
        var num = 1;
        var dots = document.getElementsByName("dots");
        var moreText = document.getElementsByName("more");
        var btnText = document.getElementsByName("myBtn");

      if (dots.style.display === "none") {
        dots.style.display = "inline";
        btnText.innerHTML = "Read more";
        moreText.style.display = "none";
      } else {
        dots.style.display = "none";
        btnText.innerHTML = "Read less";
        moreText.style.display = "inline";
      }
    }
</script>

<script>

  const triggers = Array.from(document.querySelectorAll('[data-toggle="collapse"]'));
  
  window.addEventListener('click', (ev) => {
    const elm = ev.target;
    if (triggers.includes(elm)) {
      const selector = elm.getAttribute('data-target');
      collapse(selector, 'toggle');
    }
  }, false);
  
  
  const fnmap = {
    'toggle': 'toggle',
    'show': 'add',
    'hide': 'remove'
  };
  const collapse = (selector, cmd) => {
    const targets = Array.from(document.querySelectorAll(selector));
    targets.forEach(target => {
      target.classList[fnmap[cmd]]('show hide');
    });
  };
  </script>  
  
  <!-- <script>
  $('.collapse').collapse();
  </script> -->

<!-- <script>
  function openModal() {
    document.getElementById("backdrop").style.display = "block"
    document.getElementById("exampleModal").style.display = "block"
    document.getElementById("exampleModal").className += "show"
}
function closeModal() {
    document.getElementById("backdrop").style.display = "none"
    document.getElementById("exampleModal").style.display = "none"
    document.getElementById("exampleModal").className += document.getElementById("exampleModal").className.replace("show", "")
}
// Get the modal
var modal = document.getElementById('exampleModal');

// When the user clicks anywhere outside of the modal, close it
window.onclick = function (event) {
    if (event.target == modal) {
        closeModal()
    }
};
</script> -->
</body>

<style>

@import url('https://fonts.googleapis.com/css?family=Encode+Sans+Expanded');
 html, body {
	 font-family: 'Encode Sans Expanded', sans-serif;
	 height: 100%;
	//  margin: 15px;
}
*, ::after, ::before {
	 box-sizing: border-box;
}
. .collapse {
	 display: block;
	 max-height: 0px;
	 overflow: hidden;
	 transition: max-height 0.5s cubic-bezier(0, 1, 0, 1);
}
.collapse.show {
	 max-height: 99em;
	 transition: max-height 0.5s ease-in-out;
}
.block {
	 margin-top: 10px;
	 background: #f5f5f5;
	 padding: 0;
}
.block__content {
	 border: 1px solid #ccc;
	 padding: 1.5em;
	 height: 100%;
}



  /* the following styles are for the bootstrap collapse which is also commented out
  /* #more {display: none;}
  * {box-sizing: border-box;}

  .collapse {
  display: table-row;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  transition-property:"height, visibility";
  transition-duration:.35s;
  transition-timing-function:ease;
}

@media screen and (max-width: 700px){
.box{
  width: 70%;
}

} */
  </style>
</html>
